<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Alien.js â€” Shader Noise</title>

    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto+Mono">
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
    <div id="root"></div>
    <script type="module">import{Events,Mesh,NoBlending,OrthographicCamera,RawShaderMaterial,Scene,Stage,Uniform,Vector2,WebGL1Renderer,getFullscreenTriangle,ticker}from"../build/alien.js";import simplex2d from"../src/shaders/modules/noise/simplex2d.glsl.js";const vertexShader="\n            attribute vec2 uv;\n            attribute vec3 position;\n\n            varying vec2 vUv;\n\n            void main() {\n                vUv = uv;\n\n                gl_Position = vec4(position, 1.0);\n            }\n        ",fragmentShader=`\n            precision highp float;\n\n            uniform float uMultiplier;\n            uniform float uSpeed;\n            uniform float uTime;\n\n            varying vec2 vUv;\n\n            ${simplex2d}\n\n            float fbm(in vec2 pos) {\n                float a = sin(uTime * uSpeed);\n                float b = cos(uTime * uSpeed);\n                mat2 m = mat2(-0.80, 0.36, -0.60, -0.48);\n\n                float total;\n\n                total = 0.5000 * snoise(pos) * a;\n                pos = m * pos * 2.02;\n\n                total += 0.2500 * snoise(pos) * b;\n                pos = m * pos * 2.03;\n\n                total += 0.1250 * snoise(pos) * a;\n                pos = m * pos * 2.01;\n\n                total += 0.0625 * snoise(pos) * b;\n\n                return total;\n            }\n\n            void main() {\n                vec2 pos = vUv.xy;\n\n                vec2 q = vec2(fbm(pos + vec2(0.0)), fbm(pos + vec2(0.0)));\n\n                float col = fbm(pos + sin(uTime * uSpeed) * uMultiplier * q);\n\n                gl_FragColor = vec4(vec3(col), 1.0);\n            }\n        `;class NoiseMaterial extends RawShaderMaterial{constructor(){super({uniforms:{uMultiplier:new Uniform(4),uSpeed:new Uniform(.5),uTime:WorldController.time},vertexShader:vertexShader,fragmentShader:fragmentShader,blending:NoBlending,depthWrite:!1,depthTest:!1})}}class RenderManager{static init(e,n,r,t){this.renderer=e,this.scene=n,this.camera=r,this.screen=t,this.initRenderer()}static initRenderer(){this.screen.material=new NoiseMaterial}}RenderManager.resize=(e,n,r)=>{RenderManager.renderer.setPixelRatio(r),RenderManager.renderer.setSize(e,n)},RenderManager.update=()=>{RenderManager.renderer.render(RenderManager.scene,RenderManager.camera)};class WorldController{static init(){this.initWorld()}static initWorld(){this.renderer=new WebGL1Renderer({powerPreference:"high-performance",stencil:!1}),this.element=this.renderer.domElement,this.scene=new Scene,this.camera=new OrthographicCamera(-1,1,1,-1,0,1),this.screenTriangle=getFullscreenTriangle(),this.screen=new Mesh(this.screenTriangle),this.screen.frustumCulled=!1,this.scene.add(this.screen),this.resolution=new Uniform(new Vector2),this.aspect=new Uniform(1),this.time=new Uniform(0),this.frame=new Uniform(0)}}WorldController.resize=(e,n,r)=>{e=Math.round(e*r),n=Math.round(n*r),WorldController.resolution.value.set(e,n),WorldController.aspect.value=e/n},WorldController.update=(e,n,r)=>{WorldController.time.value=e,WorldController.frame.value=r};class App{static async init(){this.initWorld(),this.initControllers(),this.addListeners(),this.onResize()}static initWorld(){WorldController.init(),Stage.add(WorldController.element)}static initControllers(){const{renderer:e,scene:n,camera:r,screen:t}=WorldController;RenderManager.init(e,n,r,t)}static addListeners(){Stage.events.on(Events.RESIZE,this.onResize),ticker.add(this.onUpdate)}}App.onResize=()=>{const{width:e,height:n,dpr:r}=Stage;WorldController.resize(e,n,r),RenderManager.resize(e,n,r)},App.onUpdate=(e,n,r)=>{WorldController.update(e,n,r),RenderManager.update(e,n,r)},App.init();</script>
</body>
</html>
